# Скрипты для переноса объектов из старых систем в Sitex

# Установка
На платформе Genum в качестве СУБД используется PostgreSQL.

На платформах Sinta, Bitrix в качестве СУБД используется MariaDB.

Разворачивание бэкапов:
| СУБД          | Linux                                                           | Windows                                                                   |
| ------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------- |
| PostgreSQL    | `psql -U <username> -d <dbname> -q -f path/to/<backupname>.sql` | `psql.exe -U <username> -d <dbname> -q -f C:\\path\\to\\<backupname>.sql` |
| MariaDB/MySQL | `mysql -u <username> -p <dbname> < /path/to/<backupname>.sql`   | `mysql -u <username> -p <dbname> < C:\path\to\<backupname>.sql`           |

# Алгоритм работы
1. Разворачивание бэкапа.
   1. Создать пустую бд `<dbname>` в соответствующей СУБД в зависимости от типа старой системы
   2. Развернуть бэкап в `<dbname>`
2. Создать кофигурацию для сайта в файле `config.yml`
3. Запустить скрипт scan.py для сохрарения отчета по категориям/типам новостей и НПА для системы генум
4. Дополнить конфигурацию исходя из отчета, сопоставить старые и новые категории
5. Запустить скрипт для переноса нужныъ объектов (`csv_news.py` , `csv_npa.py`)
6. Проверить все ли ссылки на файлы и страницы обратолись, доработать регулярки если не все
7. Проверить csv в excel
8. Испортировать csv на тестовом контуре, проверить объекты
9. Испортировать csv на продуктивном контуре, проверить объекты


# Примечания

1. В ссылках на файлы делается замена `^` на `#` , может возникнуть проблема что файла не будет по измененному пути и нужно будет переименовать путь\файл.
## Sinta
В таблице `field_config_instance` хранятся связи таблиц и сущностей, может быть полезно для понимания связи таблиц


